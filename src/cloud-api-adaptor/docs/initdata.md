# Initdata

The document describes the implementation of the [initdata](https://github.com/confidential-containers/trustee/blob/main/kbs/docs/initdata.md) spec in PeerPods.


## Initdata example

[attestation-agent](https://github.com/confidential-containers/guest-components/tree/main/attestation-agent) config file `aa.toml`, [confidential-data-hub](https://github.com/confidential-containers/guest-components/tree/main/confidential-data-hub) config file `cdh.toml` and a lightweight policy file `polciy.rego` can be passed into PeerPod via initdata.

Example:
```toml
algorithm = "sha384"
version = "0.1.0"

[data]
"aa.toml" = '''
[token_configs]
[token_configs.coco_as]
url = 'http://127.0.0.1:8080'

[token_configs.kbs]
url = 'http://127.0.0.1:8080'
cert = """
-----BEGIN CERTIFICATE-----
MIIDljCCAn6gAwIBAgIUR/UNh13GFam4emgludtype/S9BIwDQYJKoZIhvcNAQEL
BQAwdTELMAkGA1UEBhMCQ04xETAPBgNVBAgMCFpoZWppYW5nMREwDwYDVQQHDAhI
YW5nemhvdTERMA8GA1UECgwIQUFTLVRFU1QxFDASBgNVBAsMC0RldmVsb3BtZW50
MRcwFQYDVQQDDA5BQVMtVEVTVC1IVFRQUzAeFw0yNDAzMTgwNzAzNTNaFw0yNTAz
MTgwNzAzNTNaMHUxCzAJBgNVBAYTAkNOMREwDwYDVQQIDAhaaGVqaWFuZzERMA8G
A1UEBwwISGFuZ3pob3UxETAPBgNVBAoMCEFBUy1URVNUMRQwEgYDVQQLDAtEZXZl
bG9wbWVudDEXMBUGA1UEAwwOQUFTLVRFU1QtSFRUUFMwggEiMA0GCSqGSIb3DQEB
AQUAA4IBDwAwggEKAoIBAQDfp1aBr6LiNRBlJUcDGcAbcUCPG6UzywtVIc8+comS
ay//gwz2AkDmFVvqwI4bdp/NUCwSC6ShHzxsrCEiagRKtA3af/ckM7hOkb4S6u/5
ewHHFcL6YOUp+NOH5/dSLrFHLjet0dt4LkyNBPe7mKAyCJXfiX3wb25wIBB0Tfa0
p5VoKzwWeDQBx7aX8TKbG6/FZIiOXGZdl24DGARiqE3XifX7DH9iVZ2V2RL9+3WY
05GETNFPKtcrNwTy8St8/HsWVxjAzGFzf75Lbys9Ff3JMDsg9zQzgcJJzYWisxlY
g3CmnbENP0eoHS4WjQlTUyY0mtnOwodo4Vdf8ZOkU4wJAgMBAAGjHjAcMBoGA1Ud
EQQTMBGCCWxvY2FsaG9zdIcEfwAAATANBgkqhkiG9w0BAQsFAAOCAQEAKW32spii
t2JB7C1IvYpJw5mQ5bhIlldE0iB5rwWvNbuDgPrgfTI4xiX5sumdHw+P2+GU9KXF
nWkFRZ9W/26xFrVgGIS/a07aI7xrlp0Oj+1uO91UhCL3HhME/0tPC6z1iaFeZp8Y
T1tLnafqiGiThFUgvg6PKt86enX60vGaTY7sslRlgbDr9sAi/NDSS7U1PviuC6yo
yJi7BDiRSx7KrMGLscQ+AKKo2RF1MLzlJMa1kIZfvKDBXFzRd61K5IjDRQ4HQhwX
DYEbQvoZIkUTc1gBUWDcAUS5ztbJg9LCb9WVtvUTqTP2lGuNymOvdsuXq+sAZh9b
M9QaC1mzQ/OStg==
-----END CERTIFICATE-----
"""
'''

"cdh.toml"  = '''
socket = 'unix:///run/confidential-containers/cdh.sock'
credentials = []

[kbc]
name = 'cc_kbc'
url = 'http://1.2.3.4:8080'
kbs_cert = """
-----BEGIN CERTIFICATE-----
MIIFTDCCAvugAwIBAgIBADBGBgkqhkiG9w0BAQowOaAPMA0GCWCGSAFlAwQCAgUA
oRwwGgYJKoZIhvcNAQEIMA0GCWCGSAFlAwQCAgUAogMCATCjAwIBATB7MRQwEgYD
VQQLDAtFbmdpbmVlcmluZzELMAkGA1UEBhMCVVMxFDASBgNVBAcMC1NhbnRhIENs
YXJhMQswCQYDVQQIDAJDQTEfMB0GA1UECgwWQWR2YW5jZWQgTWljcm8gRGV2aWNl
czESMBAGA1UEAwwJU0VWLU1pbGFuMB4XDTIzMDEyNDE3NTgyNloXDTMwMDEyNDE3
NTgyNlowejEUMBIGA1UECwwLRW5naW5lZXJpbmcxCzAJBgNVBAYTAlVTMRQwEgYD
VQQHDAtTYW50YSBDbGFyYTELMAkGA1UECAwCQ0ExHzAdBgNVBAoMFkFkdmFuY2Vk
IE1pY3JvIERldmljZXMxETAPBgNVBAMMCFNFVi1WQ0VLMHYwEAYHKoZIzj0CAQYF
K4EEACIDYgAExmG1ZbuoAQK93USRyZQcsyobfbaAEoKEELf/jK39cOVJt1t4s83W
XM3rqIbS7qHUHQw/FGyOvdaEUs5+wwxpCWfDnmJMAQ+ctgZqgDEKh1NqlOuuKcKq
2YAWE5cTH7sHo4IBFjCCARIwEAYJKwYBBAGceAEBBAMCAQAwFwYJKwYBBAGceAEC
BAoWCE1pbGFuLUIwMBEGCisGAQQBnHgBAwEEAwIBAzARBgorBgEEAZx4AQMCBAMC
AQAwEQYKKwYBBAGceAEDBAQDAgEAMBEGCisGAQQBnHgBAwUEAwIBADARBgorBgEE
AZx4AQMGBAMCAQAwEQYKKwYBBAGceAEDBwQDAgEAMBEGCisGAQQBnHgBAwMEAwIB
CDARBgorBgEEAZx4AQMIBAMCAXMwTQYJKwYBBAGceAEEBEDDhCejDUx6+dlvehW5
cmmCWmTLdqI1L/1dGBFdia1HP46MC82aXZKGYSutSq37RCYgWjueT+qCMBE1oXDk
d1JOMEYGCSqGSIb3DQEBCjA5oA8wDQYJYIZIAWUDBAICBQChHDAaBgkqhkiG9w0B
AQgwDQYJYIZIAWUDBAICBQCiAwIBMKMDAgEBA4ICAQACgCai9x8DAWzX/2IelNWm
ituEBSiq9C9eDnBEckQYikAhPasfagnoWFAtKu/ZWTKHi+BMbhKwswBS8W0G1ywi
cUWGlzigI4tdxxf1YBJyCoTSNssSbKmIh5jemBfrvIBo1yEd+e56ZJMdhN8e+xWU
bvovUC2/7Dl76fzAaACLSorZUv5XPJwKXwEOHo7FIcREjoZn+fKjJTnmdXce0LD6
9RHr+r+ceyE79gmK31bI9DYiJoL4LeGdXZ3gMOVDR1OnDos5lOBcV+quJ6JujpgH
d9g3Sa7Du7pusD9Fdap98ocZslRfFjFi//2YdVM4MKbq6IwpYNB+2PCEKNC7SfbO
NgZYJuPZnM/wViES/cP7MZNJ1KUKBI9yh6TmlSsZZOclGJvrOsBZimTXpATjdNMt
cluKwqAUUzYQmU7bf2TMdOXyA9iH5wIpj1kWGE1VuFADTKILkTc6LzLzOWCofLxf
onhTtSDtzIv/uel547GZqq+rVRvmIieEuEvDETwuookfV6qu3D/9KuSr9xiznmEg
xynud/f525jppJMcD/ofbQxUZuGKvb3f3zy+aLxqidoX7gca2Xd9jyUy5Y/83+ZN
bz4PZx81UJzXVI9ABEh8/xilATh1ZxOePTBJjN7lgr0lXtKYjV/43yyxgUYrXNZS
oLSG2dLCK9mjjraPjau34Q==
-----END CERTIFICATE-----
"""
'''

"policy.rego" = '''
package agent_policy

import future.keywords.in
import future.keywords.every

import input

# Default values, returned by OPA when rules cannot be evaluated to true.
default CopyFileRequest := false
default CreateContainerRequest := false
default CreateSandboxRequest := true
default DestroySandboxRequest := true
default ExecProcessRequest := false
default GetOOMEventRequest := true
default GuestDetailsRequest := true
default OnlineCPUMemRequest := true
default PullImageRequest := true
default ReadStreamRequest := false
default RemoveContainerRequest := true
default RemoveStaleVirtiofsShareMountsRequest := true
default SignalProcessRequest := true
default StartContainerRequest := true
default StatsContainerRequest := true
default TtyWinResizeRequest := true
default UpdateEphemeralMountsRequest := true
default UpdateInterfaceRequest := true
default UpdateRoutesRequest := true
default WaitProcessRequest := true
default WriteStreamRequest := false
'''
```

## Annotation in Pod yaml
Generate gzipped, then base64 encoded string based on above example (`cat initdata.toml | gzip | base64 -w0`) and pass it into PeerPod via annotation `io.katacontainers.config.runtime.cc_init_data`:
```yaml
apiVersion: v1
kind: Pod
metadata:
  labels:
    run: busybox
  name: busybox
  annotations:
    io.katacontainers.config.runtime.cc_init_data: "H4sIAJ7ZDGgAA41X2ZKjSLJ95ytkdR/qQTOJ0E6b9UMAAWKV2AVtbWXsILFILGL5+gllVt7O6uqcGqXJ0nBOnHD38Dju8vKkqrM2LWa/z740qbfar79gj6husqp8mhYvxMviC4b9EXqt9yf2xfNe2qrIv6B3X79+xf5oq2tUfguqMs6S5s+/Pb8EVVB985C9q/PnirRtb7/hOLHcvSzQH/HbfrFffMX+vuzq/3JJENXt078vX7B/Pz8U5HhlRkPN4FmeBgZ8tWIyzzP5haZBuU1Az1Mg4U0NN5WUWHGsV6yjIsm7sB1vEa6TFN8zqiOIlcunj0ABKpQwSgV9aEBJBlcOECakUplWF+sBGuBEJYqFGGWavVWufbs59qaUNdgzvcNYqnpgQMpjT2NUpA9Eoslg/0pCJz2vmqwhWRprEurAMkB/I2tkeqHlYWE1/opqXXuzwGQt6Fn1lZFhwIZSLbm1oGVYNMFbrKaaE4jYfjEqDJhkI+mVCUyKoXivNgNM2EejfDAHegLC226OAa7K8YPLPHLZ8zjr7tls505vHmOvcfc9r3PIuLpV/sr8EH8l05ClzJEwNUsxZU3tYfJKJjGghe7ZzTGfI3vftrqQgWeZMl9zAPr++CEHrc5qpsnKfZLATAYLjtbvnM77K0aFFAZUE4A1TzE9eAJEUKGjVJn4RnhUvZUyRaNywQwYLgB+YNInbmtOY99afLCfB1WhY96I40k/LcGVKVjrce/5tR/ecMWke53e6ulhGpqahpmXaGILVl6MB1d5lx6v/lrfdvgGi/rDgQ2krXM0b3PleNjgoS7V7EG6RO0ibNfSdVSoU7QrRDDSwjnOzqveX25QyVELI/YW2G1jVeLU2xGjUsPOO+8N0ee2OOvy2fHMuWG+XDMc0LI7XJ2z+LxjDmRmuUtrqUnkfGU72GLDQUNhT2Ib1EpvjHu93eOHxraGC5g4dop3G8kfG5KNV4LMNAk5qVMSCMLk2Fkz5A6WrOii9KFyWkTVQV/bFzU3zNFZFG157KuwWlthvHePV3PdC6iqKQC4y+ECApmqnicWYlBVDZniaNoeHs6SbTyOnEI+gHEPADCAQiXXe3rN0GEv0Ok0LABHGl0iINqrZXPLMqxdCtQOle3DuQn9plA3fsrneQgXGbWpe/uh+B2TnOokNvj1kJ03TVeEh35+Ws45kxTPLFbaV1ZzSRtfbge2thKO13FvsfP43VDnt8XxMie6I0mYKS2tDqkM8UV7orcTkXls5N72DmYQrVR68T3jMiNlzeSRbFFC99uoPG8XD84znF3T5Fqe+ExNNiDDFUbXdyZxemQdvR0rbBSyHcVkmj7sxFrmpCZQ50AUq6XGErI05YLsEVfejR8iQ53ZSQu3hLjhL4ymrg9q2p8xxoG++kASczWNgEgo02YCYOqbqfWFhJRon7St9mEad+O0zLlOGYvjI2y6833eADclfUwmVY8miknFj3qb/P77m/5BhflZ/Z7q+FRp7EsQpt91+7twN1VwjZ4K+rUrswEJLF53Jf4qwGFUtpmX/xs9tF5Wol6AP5c/VyDdraPv7xu0+I8/kXZf/eBPrPSK6MkWBN/Q89e/q/fL8mX1sv6u3Ujev/3v+s0aDNLvR/eu3xRgKO7HUqv6owdOr6ph05wO2Bz0Kg0SE2CV1vdc8oOo8/8ErJCMA4O+vG5iULt3HcO+CxnrF+HNL6w8KPKnMv7QECxL/qDhgUwTSuqXWspDpcGcs5DKatPT6rvECoxqwFimFu/NwFZtbYkaxcW11cSw80tQ7BONs5aereRYMEEd3cZ31RTMhWVLJnHzkRzL1PrMGPwkMxA1ALhSjGRU8grZ5P7dhn039tEFmjLFv+3a95KGWpNnb3L3LKDQgh8bQ24ZH3OAmllrIBcXjk4xaOfR+dAUaYCiW8DhMIHwvSmwV/YaFmznLK0rxkPi5qyEBw+fzS2/uGf5QweRUQdVWCsjbHVhSfLB6SFwDs8Tmy4LpCAOi4lrCAHNM04C4FBwhOt3FVBFcmXq2uiqQTNWfux7AFYihFKMX8QVGRwtoSXadbNf2dhZXtV33td394N5UHuc5UZ0rzxoNpt53w832o6ZshBkoM6DNnHvCQPFlFDu+bHrxEC8Y0sH2HATGIddc6hQK2KfU4XGP10VxN6h0AEFEYDoPyokNDSw/Q92GkNJsWn4dmySyfcyKnk6azigqlR5SCjQoxCf1TcBjUJDGZWgZ3dYA1Wmn6TYkxWqjviBlXl2QZBA8DOZ+UbG/EWGfWfj3l38iaz/jEx+JcNo5ifX+Feys9wb6g/xQgoyTEpHF8YctvMwf0SpvcGCoqDtwpDCO09IOBFyFBtmHnE4rbcyvV96Z1fkHL1r9ftqp9FOYl+6yJjfaeQRgYr6ioWEcJSh88N0gC7tpgL719nN4V0e2CbKC09TKp2isvU+agVKYvJPwOwZnyzKz/gpNGk880MntJeRw54B9nTGl3yUK3aBZW0HKT27kzQZMSUFg6vqZFeQnrwm9pKyslnQih3u2oZ4yOaU7Kdi3/SUvrcXHDH2GRaYNpdPWcKv23AYYsKhhJGuDF1pGt0XCz7dXKKCiusHT1XECMN5tNm6ghymyj6aD7aJ+Y/qYdJLfMfku208AQ/Qkl7VrvnYnE9CL557eDxUO5YPNHip3HIeixfBKIvwHEQLidlipHao5/U8iEa4I5NCXBE+TzJOJlTSWoq48OyuEvloMRpxLJmq2eRHKrDm907YCt3llhywkExWurdjut2taxiSDb0bua8CF3XOmL2wGY4vndCS17Lo37d8f3MUar480VBU6J0e+0dMSVxH6E5uKeO9lUEdD0472VUEQjRFiifHdGsUud647jHIOeFRHxvKzQrjfAPGJVTkFgvyTuzvwDQnRy3MnR8vDTk8nkdAZgc0dN0uxNXmIGF1LGAMkZeuRrCVJmk62nQVS0OMVWVqtDrTTvwD76J8s95x7v0+ry3tUfBZBDv4YKDRd1V1ja3tvVsxOCl2ek0O2VQWMMGGsexCPN4sN5fbTZADBq9iXx1Mt+PEh7+KV9M496ThnoXVeZcE3vIckpfRHDcOvl/NXQXzp/XJHfaEKUxniycBBdM9PmQ5MFLCHY7RyaCEi7LLk3qRn1vRuVj4ejWOQ2I69VlxdaySdG4ZSrRIFpdL7Z0uXrdaq//jQHCr8iwYX+ooqd5/y9284Ool0Qx9y/bbGwDDsuJWoVYdd21XRy/XaOyrOmxesvKzNxH69fjXuqy8dS2G/d+MiWKvy9vZw8u7qPnXrI7QsjIKZ/44O57ArE+jclZ3edTMAq8sq3bmR7PoifZahGqrWVt30QsWfuehq9vIZnmkRXfE185++30Wo6Ek+gtQR2gl/T7E/AKne2XoV8MH1HO7/wcxyFhX4y9QcIiCU10FUdN8uh0XtUckYQ+U489ouKeViZDfefMZ5ljmKCr6ZMpR8Rnm1OU5X6Dj/AygRV6otyj+4lN3taioHv+Yxb8xPWF66+WRldVtVsWNnnp1JFdd2X4ahJ4lpZf/nLEfQa1Xt790AKHa5pcoox3trNSiJps+TYp5C1E9wFsaFVHt5f89gjcwX7ZRHXvBLzi1qmujT6lsL2t/kQq7zlCl/vOBPW/wfwDvoi9HzREAAA="
spec:
  containers:
  - image: quay.io/prometheus/busybox
    name: busybox
    resources: {}
  dnsPolicy: ClusterFirst
  restartPolicy: Never
  runtimeClassName: kata-remote
```

## Structure in `write_files`
cloud-api-adaptor will read the annotation and write it to [write_files](../../cloud-providers/util/cloudinit/cloudconfig.go). Note: files unrelated to initdata (like network tunnel configuration in `/run/peerpod/daemon.json`) are also part of the `write_files` directive.
```yaml
write_files:
- path: /run/peerpod/daemon.json
  content:
- path: /run/peerpod/auth.json
  content:
- path: /run/peerpod/initdata
  content:
```

## Provision initdata files.
`/run/peerpod/aa.toml`, `/run/peerpod/cdh.toml` and `/run/peerpod/policy.rego` will be provisioned from `/run/peerpod/initdata` via [process-user-data](../cmd/process-user-data/main.go).

It also calculates the digest `/run/peerpod/initdata.digest` based on the `algorithm` in `/run/peerpod/initdata` and its contents.

`/run/peerpod/initdata.digest` could be used by the TEE drivers.

The digest can be calculated manually and set to attestation service policy before hand if needed. To calculate the digest, use a tool (for example some online sha tools) to calculate the hash value based on the initdata raw string. The calculated sha384 is: `52af3178dd7ad4bf551e629b84b45bfd1fbe1434b980120267181ae3575ea20ca9013b8eadf31d27eed7ff2552d500ef` for above sample.

For example, for [IBM SE](https://github.com/confidential-containers/trustee/blob/main/attestation-service/docs/parsed_claims.md#ibm-secure-execution-se), the `se.user_data` can be set as:
```
allow if {
    ...
    input["se.user_data"] == "52af3178dd7ad4bf551e629b84b45bfd1fbe1434b980120267181ae3575ea20ca9013b8eadf31d27eed7ff2552d500ef"
    ...
}
```

## Global initdata
If all of your applications(Pods) are using same initdata, it's convenient you set the `INITDATA` in configmap `peer-pods-cm`, so that you don't need add initdata annotation in each Pod yaml. For example, for libvirt provider, it looks like:
```
kubectl -n confidential-containers-system get cm peer-pods-cm -o yaml
apiVersion: v1
data:
  CLOUD_CONFIG_VERIFY: "false"
  CLOUD_PROVIDER: libvirt
  DISABLECVM: "true"
  ENABLE_CLOUD_PROVIDER_EXTERNAL_PLUGIN: "false"
  INITDATA: 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
  LIBVIRT_NET: default
  LIBVIRT_POOL: default
  LIBVIRT_URI: qemu+ssh://root@192.168.122.1/system?no_verify=1
  LIBVIRT_VOL_NAME: podvm-base.qcow2
  SECURE_COMMS: "false"
kind: ConfigMap
```

## TODO
A large policy bodies that cannot be provisioned via IMDS user-data, the limitation depends on providers IMDS limitation. We need add checking and limitations according to test result future. 
