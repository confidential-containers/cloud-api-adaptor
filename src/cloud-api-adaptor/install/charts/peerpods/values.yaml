# Default values for peerpods (CAA) chart

# Namespace where peerpods resources will be deployed
namespace: confidential-containers-system

# Secret configuration
secrets:
  # How to handle provider secrets:
  #
  # - "create": Helm creates the K8s Secret from providerSecrets values.
  #   WARNING: Not recommended for production. Secrets passed via helm install
  #   are stored in Helm release history and can be retrieved with `helm get values`.
  #
  # - "reference": Reference a pre-existing K8s Secret by name.
  #   Recommended for production. Secrets are managed externally (kubectl, Vault,
  #   External Secrets Operator, etc.) and never flow through Helm.
  #
  # Future modes may include: "eso" (External Secrets Operator), "sealed" (Sealed Secrets), etc.
  #
  mode: "create"

  # Name of existing secret (only used when mode: "reference")
  # The secret must contain the required env var keys for your provider.
  # See providers/*-secrets.yaml.template for the list of required keys.
  existingSecretName: ""

# CAA (Cloud API Adaptor) image
#
# Two image variants are published:
# - Release image (<commit>): smaller, no CGO/libvirt bindings
# - Dev image (dev-<commit> or "latest"): includes CGO bindings for libvirt/docker
#
# During development: "latest" works for all providers
# At release: most providers use <commit>, libvirt/docker use dev-<commit>
#
# Note: libvirt/docker provider files override this with the dev image.
image:
  name: quay.io/confidential-containers/cloud-api-adaptor
  tag: "latest"

# Cloud provider: libvirt, aws, azure, gcp, ibmcloud, vsphere
provider: libvirt

# Maximum number of peer pods allowed to run simultaneously
# This limit prevents resource exhaustion on the cloud provider
# Set to "0" for unlimited (not recommended for production)
limit: "10"

# Resource controllers (peerpod-ctrl subchart + webhook)
# peerpod-ctrl manages lifecycle of peer pod cloud resources and cleans up dangling VMs
# Webhook (temporary Job) modifies pod specs to use peer-pod extended resources
# Configuration options documented in ../../../peerpod-ctrl/chart/values.yaml
# NOTE: Webhook requires cert-manager to be installed in the cluster
resourceCtrl:
  enabled: true
  # Git reference for webhook kustomize config (until webhook gets its own helm chart)
  gitRef: "main"

# kata-deploy subchart configuration
kata-deploy:
  snapshotter:
    setup: ["nydus"]
  defaultShim:
    amd64: remote
    arm64: remote
    s390x: remote
    ppc64le: remote
  shims:
    clh:
      enabled: false
    cloud-hypervisor:
      enabled: false
    dragonball:
      enabled: false
    fc:
      enabled: false
    qemu:
      enabled: false
    qemu-runtime-rs:
      enabled: false
    qemu-nvidia-gpu:
      enabled: false
    qemu-nvidia-gpu-snp:
      enabled: false
    qemu-nvidia-gpu-tdx:
      enabled: false
    qemu-snp:
      enabled: false
    qemu-tdx:
      enabled: false
    qemu-se:
      enabled: false
    qemu-se-runtime-rs:
      enabled: false
    qemu-cca:
      enabled: false
    qemu-coco-dev:
      enabled: false
    qemu-coco-dev-runtime-rs:
      enabled: false
    remote:
      enabled: true
